{% extends 'core/base.html' %}
{% load bootstrap3 %}
{% block title %}
    Despesas por Categoria
{% endblock %}

{% block content %}
<h1>Categoria: {{categoria.descricao|title}}</h1>
<div style="text-align: right; margin-bottom: 15px;">
    <form method="GET" class="form-inline">
        <div class="input-group">
            <input type="text" name="q" class="form-control" placeholder="Buscar despesa..." value="{{ request.GET.q }}">
            <span class="input-group-btn">
                <button type="submit" class="btn btn-primary">
                    {% bootstrap_icon 'search' %} Buscar
                </button>
				{% if request.GET.q %}
                <a href="{% url 'despesas_por_categoria' categoria.id %}" class="btn btn-secondary">
                    {% bootstrap_icon 'remove' %} Limpar
                </a>
                {% endif %}
            </span>
        </div>
    </form>
</div>
<div class="panel panel-default">
    <div class="panel-body">
        <span class="badge" style="background-color: #d9534f; color: white;">
            <strong>Total de Despesas da categoria:</strong> R$ {{ total_despesas|floatformat:2 }}
          </span>
    </div>
</div>
<table class="table table-hover">
    <thead>
        <th>Despesa</th>
        <th>Valor</th>
        <th>Conta</th>
        <th>Categoria</th>
        <th>Data</th>
       
       
        <th class="text-center">Editar</th>
		<th class="text-center">Excluir</th>
    </thead>
    <tbody>
        {% for despesa in despesas %}
        <tr>
            <td>{{ despesa.dispesa }}</td>
            <td>R$ {{ despesa.valor }}</td>
            <td>{{ despesa.conta }}</td>
            <td>
                {% for categoria in despesa.categorias.all %}
                    {{ categoria.descricao }}{% if not forloop.last %}, {% endif %}
                {% endfor %}
            </td>
            <td>{{ despesa.data }}</td>
            <td class="text-center">
                {% bootstrap_button content='' href=despesa.get_absolute_url button_type='link' icon='edit' button_class='btn btn-primary' size='sm' %}
            </td>
            <td class="text-center">
                {% bootstrap_button content='' href=despesa.get_delete_url button_type='link' icon='trash' button_class='btn btn-danger' size='sm' %}
            </td>

        </tr>
        {% empty %}
        <tr>
            <td colspan="7" class="text-center">Nenhuma despesa registrada.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<a href="{% url 'categoria_list' %}" class="btn btn-info">Voltar</a>
{% endblock %}
